function s = Qmult(q,r)
    if (size(q,2)==4)
        s0 = q(:,1).*r(:,1) -  q(:,2).*r(:,2) - q(:,3).*r(:,3) - q(:,4).*r(:,4);
        sv = repmat(r(:,1),[1,3]) .* [q(:,2),q(:,3),q(:,4)] + repmat(q(:,1),[1,3]) .* [r(:,2),r(:,3),r(:,4)] - cross([q(:,2),q(:,3),q(:,4)],[r(:,2),r(:,3),r(:,4)]);
        s = [s0 sv(:,1:3)];
%     elseif (size(q,2)==2)
%         s0 = q(:,1).*r(:,1) -  q(:,2).*r(:,2);
%         sv = r(:,1) .* q(:,2) + q(:,1) .* r(:,2);
%         s = [s0 sv];
%         s = [q(:,1).*r(:,1)+q(:,2).*r(:,2) q(:,1).*r(:,2)+q(:,2)*r(:,1)];
    end
    
end

