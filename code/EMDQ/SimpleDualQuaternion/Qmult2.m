function s = Qmult2(q,r)
    if (size(q,2)==4)
        s0 = q(:,1).*r(:,1) - q(:,2).*r(:,2) - q(:,3).*r(:,3) - q(:,4).*r(:,4);
        s1 = q(:,2).*r(:,1) + q(:,1).*r(:,2) - (q(:,3).*r(:,4)-q(:,4).*r(:,3));
        s2 = q(:,3).*r(:,1) + q(:,1).*r(:,3) - (q(:,4).*r(:,2)-q(:,2).*r(:,4));
        s3 = q(:,4).*r(:,1) + q(:,1).*r(:,4) - (q(:,2).*r(:,3)-q(:,3).*r(:,2));
       
        s = [s0 s1 s2 s3];
    end
    
end

