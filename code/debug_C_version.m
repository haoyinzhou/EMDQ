clear 
clc
close all
IniToolbox;

X1 = [ 583.659 766.554 582.446 872.695 873.767 862.049 611.003 591.727 337.884 680.599 610.552 580.838 752.721 851.171 662.315 862.851 551.288 882.874 643.929 575.222 907.988 508.423  624.95   453.8 880.498 682.809 672.672  694.85 700.423  692.91 902.756  890.35 870.739 52.0589 890.707 282.031 323.677 612.376 718.651 321.302 756.027 640.729 509.235 597.012 510.411 870.503 509.291 707.425 509.077 713.287 656.113 505.096 184.744 749.462 599.631 519.269 597.987 364.136 751.248  327.45 852.592 524.875 468.111 916.912 253.421 544.799 375.778 739.345 605.585 422.064 598.868 480.982 720.623 667.916 690.436 649.347 859.903  675.36 596.725 622.877 196.376 748.359 761.913 599.754 201.726   441.9 332.891 602.785 610.403 351.543 579.166 352.042 621.574 854.943 681.671 895.833 507.484 643.732 655.614 920.169 774.275 272.378 544.554 194.338 861.367 237.213  484.01 434.918 717.739 740.488 757.026 687.992 228.288 355.449 750.344 535.605 292.051 795.636  347.09  825.26 751.827 766.735 481.559 184.181 856.298 859.307 911.045 401.362 672.622 506.141 345.231  176.72  300.82 898.158 644.321 856.063 699.196 913.996  799.92 900.094 856.171 921.984 105.144 752.622 744.973 725.276 589.839 916.982 170.119 314.785 505.678 347.466 300.454 838.553  505.38 810.889 764.538 569.228 882.933 695.511 493.436 392.701 302.041 477.302 314.754 321.744 638.627 880.251  209.88 838.797 692.682 604.541 562.962 555.796 583.296 864.121 918.023 467.058 348.709 247.934 498.327  468.16 779.176 501.185 254.225  645.51 833.733 413.923 357.529 195.752 348.893 325.722 809.437 366.054  778.34 217.306 209.175 776.951 802.106 716.412 900.641 823.079 857.636 633.915 857.842 776.842 672.986 721.651 700.867 857.958 499.091  612.75 750.568  240.64 551.861 383.553  497.32 671.561 380.734  533.14 283.104 363.344 922.701 533.076 782.702 368.208 922.717 736.789 658.763 657.044 672.928 736.521 902.295 584.702 709.033 606.892 371.311 221.914 926.076 231.981 656.119 517.632 561.835  826.21 485.592 257.013 737.426 766.038 784.076 195.816 273.936 733.267 540.048 531.763 208.019  264.63 583.039 204.985 445.533 671.125 500.953 488.648 536.332 698.601 733.335 826.764 585.517 805.145 500.291 620.439   594.2 608.145  698.34 233.938 496.844 431.692 468.479 316.479 590.693 320.754 527.678  893.44 326.828 220.148 601.479 280.086 829.035   531.4 192.154 229.256 700.433 597.096 798.187 870.981 506.137 831.457 64.1527  745.56 811.135 473.103 827.931 433.995 782.431  404.31 830.222 687.111 698.465 739.109 842.022 214.431 336.331  686.62     562 170.001 568.229 263.976 333.053 819.129 344.436 493.675 751.546 603.385 266.771 409.693 167.779 678.916 766.499 361.005 317.738 808.946 849.173 273.365 316.391 260.991 311.037 623.137 378.938 650.135 640.907 466.599 253.395 239.869 628.755 550.264 821.084 628.403  601.76  601.38 808.105 355.032 415.162 752.102 743.714 603.742 219.446 188.872 339.772 562.014 675.771 109.809 317.997 871.324 328.787 100.673 808.177 379.628 441.227 734.671 317.902  184.12  621.87 387.903 647.093 212.321 313.796 462.605 253.368 935.782 220.747 269.528 796.998 615.041 477.553 221.469 438.003  451.32  315.36 427.398 648.798 879.409 161.048 723.143 61.8983  243.49 718.114 320.167 138.307 186.351 890.458 478.677 590.257 666.228 810.343 338.123 234.347 269.903 412.098 281.973 85.1917 616.497 361.557 175.494  361.13 216.072 185.147 221.162 133.522 151.178 668.829 129.593 437.888 251.824 186.027 145.034 135.862 150.992 272.219 844.381 803.996 380.445
272.224 54.7824 284.229 517.909  527.82 525.991 318.595 262.843 439.785 347.241 319.098 263.422 62.1676 513.944 354.369 509.946 269.368  524.95 287.929  210.39  144.27 344.938 348.956 396.479 191.127 336.351 263.666 305.106 325.272 348.694 526.092 142.944 200.539 383.776 143.348 358.013 412.923 340.143 327.054 448.559 317.667 342.352 364.489 184.051 306.575 251.983 402.328 92.6914 402.335 273.421 316.101 145.752 422.464 279.367 316.998 124.748 317.915 431.189 421.803 440.046 213.434 318.409 399.968 317.142 474.208 222.363 416.704 291.935 154.518 167.939 204.553 454.475 288.528 304.405 247.749 302.103 293.495 133.308  131.94 153.595 357.666 347.576 250.811  344.86 466.755 437.504 476.806 264.388 351.771 395.203 196.806 393.288  164.77 236.051 326.667 280.523 249.649 215.559 327.833 209.027 127.897 268.366 241.238 110.295 241.962 397.777 415.805 383.928 338.031 195.098 45.3672 288.533 426.708 469.747 44.6022 420.442 202.915 164.001  473.75 289.365 43.5925 311.072 390.131 462.004  258.68 204.036 174.373 92.6781 360.808 416.934 379.473 440.478 407.047 187.545 41.0643 257.218 54.5105  204.05 168.578 187.799 166.063 178.562 440.053 42.6869 302.973 385.217 521.606 303.942 477.457 423.406  45.538 435.658 398.117 194.135 416.346 239.936 162.678 191.007 311.943 281.628 160.357 388.697 469.577 382.075  423.37 246.521 276.002 117.571 380.838 194.048 360.775 330.237 237.687 194.793 221.223 279.518 224.885 346.745  418.22 447.256  311.41 368.532  258.26 321.013 451.956  86.601 191.895   350.5 406.625 408.133 417.913  246.05 197.021 239.283 192.941 456.946 475.261 332.581 361.815 370.575 137.969 173.703 327.651 297.841 264.929 61.9142 232.073 197.745 115.109 263.464 323.046 146.352 71.0467 488.691 257.529 196.095 409.383  43.772 230.882 224.618 461.563 241.712 283.551 224.473 299.967 221.679 98.3244 45.0274 473.661 474.809 327.955 68.0635  194.93 222.912 234.553 197.949 346.686 446.125 308.778  485.25 302.946 450.657 158.132 185.171 175.589 435.041 305.328 274.169 162.954 407.659 479.799 183.619 199.074 269.889 484.076 412.824  250.08 372.335 364.176 86.0131 491.582 401.678  481.47 208.111 252.933 460.217 222.893 167.301  363.97 191.891 333.295 130.978 64.9259 238.039 142.883 431.413 56.8355 442.069  194.51 348.126 157.836  306.74 230.276 418.933 174.538 214.011 275.553 46.6579 435.841 144.473 68.1151 120.617 458.175 346.083 465.251 124.159 393.207 408.171 454.682 102.006 112.433 312.362 158.693 395.234 435.671 320.111 67.6842 207.037 127.245 477.774 405.459 115.074 222.198 368.786 137.168 482.986 391.106  188.06 430.049 454.329 309.609 175.164 456.194 139.157 407.778 473.135 460.867 224.777   494.1 102.731 119.793 40.9527   493.7 401.777  479.62 75.6211 229.234 111.588 309.338 357.395 441.878  403.99 129.434 43.3525 204.978 36.4399 169.624 169.111  402.26 367.626 240.981 39.6083 39.7815 173.452 366.786 485.594 405.546  36.082 386.823 461.675 189.562  168.13  273.16  461.49 251.666 364.852 394.158  245.92 493.873 392.146   159.3 414.626  349.61 384.701 434.767 225.052 358.019 218.184 401.219 242.903 400.143 28.4939 351.226 54.7628 152.256 434.989 210.633 428.644 378.055 142.063 422.551 228.866 183.224 291.502 418.325 231.105 451.988 117.516 122.634 184.176 49.3962 130.557 356.022 179.654 386.561 277.336 276.583 45.7053 386.887 28.3093 385.149 123.038 421.935 106.729 116.847 401.298 92.4557 158.693 364.454 468.773 179.137 341.729 376.142 159.306 213.427 91.4637  96.363 157.306 148.837 205.993];

X2 = [593.048 782.307 590.213 872.545 873.656 861.948 616.102 602.524 340.977 685.216 616.102 590.009 770.499 851.235 667.212 862.986 558.548 882.117 649.686 588.694 917.202 513.575  629.65 456.305 888.886 688.258 678.971 700.627 706.026 697.579 902.563 900.216 877.967 493.269 900.216  286.02 327.411 617.185 722.218 324.716 760.033 645.949 513.151 612.147  516.87 876.543  512.17  725.68  512.17 719.689 661.692 518.945 190.599 780.417 604.839 533.651 602.801 367.415 749.336 330.802 860.659 531.153  470.37 918.194 258.552 556.068 378.545 744.903 622.687 430.807 612.803 479.101 726.905 673.372 697.191 655.076 862.438 692.408 613.113 640.085 198.255 750.961 769.064  604.52  208.81 445.881 335.697  611.92 615.929 354.059 593.691 354.059 638.646 861.834 686.687 900.897 515.012 654.095 660.898 927.177 785.137 273.024 555.811 180.564 867.852 242.342 484.931 437.865 721.632 749.135 774.612  694.08  233.89 357.859 768.893   536.9 292.027 804.797 349.284 829.736 770.803 770.294 483.516 191.804 861.773 867.442 919.522 408.676 676.865 506.591 347.807 182.841 303.399  908.62 663.222 861.773 718.994 921.139 809.391  908.62 865.899 930.164 113.954 770.803 750.859   726.3 635.867 919.162 178.724 317.224 521.604 350.045 304.006  846.59 506.591 817.781 773.834 583.425 885.243 701.434 505.409 395.764 305.982 480.541  318.59 322.665 644.547 746.104 213.826  846.59 697.157 609.853 573.704  568.92 595.908 867.633 924.455 471.966 351.384 252.914 503.861 471.473 785.463 507.463 259.801 663.629 842.743 416.141 360.773 200.722 351.384 327.147 818.112 369.402 787.013 224.211 216.298 779.108 802.789 719.749 910.026 832.835 859.438  639.48 862.664  618.13 681.757 730.202 821.893 862.003 507.463 629.985 768.661 245.981 564.684  388.27 498.759 690.422 384.846 544.819 287.157 367.889 926.261 544.819 787.274  371.72 931.826 754.286 653.696 651.809 501.056 754.724 911.203 598.733 715.974 621.691 374.239  227.96 928.843 237.819 661.852 514.863 577.189 697.191 496.573 261.101 743.203 770.583 793.698 200.722 278.623  742.14  552.09  538.26 215.988 268.651 592.733 207.453 449.154 690.139 496.606   491.8 530.908 706.814 740.269 822.473 598.733 814.801 504.187 636.943 599.648  625.81  717.85 265.685 509.354 432.991 482.702 318.827 605.506 323.121  542.27 896.313 328.766 225.753 617.355 279.678 833.291 548.961 198.654 228.995 720.281 614.001 793.209 823.823 503.569 841.885 69.2447 743.964 807.064 486.346 837.659 489.953 792.392 406.914 826.634 691.825 717.613 745.822 851.894  222.11 339.205 704.311 574.263 172.893 585.158 268.866 335.656  826.41 347.741 492.798 755.699 619.781 271.729 418.128 173.063  672.89 762.063 365.227 319.518  819.82 858.277 265.229 319.518 265.775 312.994 640.175 384.846 665.951 646.349 470.305  258.09 243.889 643.746  805.06 829.882 646.301 618.199 618.124   807.2 356.948 419.936 770.998 762.095 621.579 222.839 196.814 341.719 580.862 677.283 119.728 320.148 880.667 331.535 109.962  815.07 381.655 443.955 741.794 319.518 187.719 638.332 390.732 652.468 216.452 316.795 470.373 256.404 941.834 225.802 268.759 794.081 633.912 482.787 204.206 447.237 451.322 316.628 429.922  652.05 889.153 166.902 730.908 31.1775 244.478 716.987 320.932 146.824 169.615 900.922 487.981   608.3 683.995 811.929 341.233 238.607 269.708 416.823 274.325 89.7764 633.912 363.707 159.136 364.067 205.702 169.615 225.802 93.7488 141.553 673.014 138.246 527.439 253.903 189.721 128.896 128.332 121.855 268.826 853.725 814.848 384.613
279.586 66.1666 290.016 518.013 527.818 526.014 315.587 271.514 460.385 335.906 315.587 270.562 73.3728 513.958  345.66 510.252 276.324 524.401 285.012 221.129 136.742 348.183 343.751 403.291 180.567 326.846 260.004  295.87 313.566 336.381 526.103 137.256 188.309 286.805 137.256 391.985 436.875 335.352 313.476  470.86 301.372 335.708 367.059 194.395 311.912 233.973 405.116 103.684 405.116  264.45 309.341 168.189 460.972 338.895 315.607 146.565  315.98 448.097 395.258 461.842 200.861 322.049 404.154  287.75 504.921 234.754 434.354 279.319 166.473 197.751 214.753 454.742 277.349 297.484 243.368 296.277 269.941 143.574 145.824 163.105 396.217 329.963 240.555 341.333 502.635 441.672 495.436 271.202 346.977 416.019  208.15 416.019 175.162 221.326  316.38 257.021 259.347 222.828 320.768 194.522 129.162 307.844 252.406 168.458 226.833 432.658 419.693 393.974 323.886 192.752 56.3081 280.823 461.921 484.595 55.1331 418.717 243.096 160.434  490.29 269.166 54.7904 293.727 395.472 500.008  239.98 193.173 163.814 125.638 348.504 417.235 402.132 479.624 434.894 176.215 56.3561  239.98 65.5979 190.321 163.577 176.215 158.346 166.135 479.293 54.7904 289.025 366.849 526.745 276.954 515.989 448.072 71.4061 454.257 426.299 184.509 417.235 226.747 161.144 202.591 284.548 274.025 183.826 404.161 493.353 387.193 447.499 284.786 273.257 228.529  418.71 184.509 346.199  327.24 248.431  207.33 231.086 258.203 208.161 353.745   438.4 479.835 317.873 374.812 245.856 324.885 481.633 99.7389 182.312 365.372 426.148 444.945   438.4 283.803 188.095 272.911 186.875 490.594  509.83 312.729 336.989 353.502 131.363  167.42 299.979  294.69 245.859 380.865 231.317 195.399 119.601 244.693 324.885 158.278 81.4704 520.711 267.346 229.227 411.974 56.7525 262.947  237.41 488.509 274.858 259.251  237.41 281.053  255.57 95.7797 55.0509 450.458 453.547 517.434 79.4254 183.347 232.747 228.894 207.493  369.51 480.274   280.2 517.377 296.059 448.038 172.949 243.368 197.813 466.461 291.193 261.549 159.271 444.945 506.958 182.098 213.581 280.682 518.369 443.794  258.29 410.615 374.245 98.9273 386.216 405.113 473.297 207.858 244.708 421.224 232.747 162.331 367.942 201.463 331.467  143.71 76.8454 234.249 166.415 439.332 84.4379 465.916 205.036 378.727 176.874 280.634 267.716 454.601 185.083 255.207 258.249 70.2679 472.978 203.646 80.0983 134.191 422.546 81.0859 460.986 122.853 426.477 384.003 417.897 131.211  111.28 231.511 155.321 408.965  398.92 310.238  79.742 203.714 125.851 511.754 428.635 126.003 233.704  408.92 152.958 512.027 415.178  179.76 451.251 451.237 294.141 184.777 485.186 172.238 446.471 448.972 429.237 258.756 514.137 103.359 117.715  88.658 514.137 434.106 502.583 90.8134 262.947 122.616 304.945 364.138 472.935  439.76 139.489 431.097  194.91 54.7351  180.06 179.503 371.756 390.835  267.34 49.7963 50.9093 181.587 404.212 523.327 427.097 57.9439 373.574  517.41 230.002 159.737 309.762  503.17  237.94 384.729 403.086  237.23 514.137 431.809 169.366 430.676 341.481 421.944 458.029 246.312 394.244 203.286 437.867 284.168 371.839 46.7998 356.904 104.501 181.971 440.859 249.403 436.106 367.198 135.821 463.052 222.956 141.902 331.146 394.483 269.388 493.301  174.35 117.584 207.109 70.1078 140.676 330.606 218.116 421.971 317.587  299.17 92.0745 428.364 46.7998 404.802 180.985 439.075 163.753  174.35 437.867  148.03 213.803 354.951 510.713 82.6785 379.315 414.782 217.983 269.835 145.574 149.991 150.955 144.713 239.707];

% X1 = X1';
% X2 = X2';

[EMDQscale] = 1.0;%GetDataScaleForEMDQ_2D( size(I2,2),size(I2,1));
EMDQparams = EMDQ_Initialization_2D(EMDQscale);
% the main algorithm
[inliersMask_RANSAC, inliersMask_final, dq_points, mu_points] = EMDQ(X1, X2, EMDQparams);

